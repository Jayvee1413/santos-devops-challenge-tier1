{
  "Resources": {
    "Tier1BeanstalkInstanceProfileRole25F1788E": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "ec2.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/AWSElasticBeanstalkWebTier"
              ]
            ]
          }
        ],
        "RoleName": "JVSANTOSTier1BeanstalkInstanceProfileRole",
        "Tags": [
          {
            "Key": "Application",
            "Value": "JVSANTOSTier1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "JVSANTOSTier1BeanstalkAwsArchitectureStack/Tier1BeanstalkInstanceProfileRole/Resource"
      }
    },
    "Tier1BeanstalkServiceRole00DAA13C": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "elasticbeanstalk.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth"
              ]
            ]
          },
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSElasticBeanstalkService"
              ]
            ]
          }
        ],
        "RoleName": "JVSANTOSTier1BeanstalkServiceRole",
        "Tags": [
          {
            "Key": "Application",
            "Value": "JVSANTOSTier1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "JVSANTOSTier1BeanstalkAwsArchitectureStack/Tier1BeanstalkServiceRole/Resource"
      }
    },
    "Tier1BeanstalkAppInstanceProfile": {
      "Type": "AWS::IAM::InstanceProfile",
      "Properties": {
        "Roles": [
          {
            "Ref": "Tier1BeanstalkInstanceProfileRole25F1788E"
          }
        ],
        "InstanceProfileName": "JVSANTOSTier1BeanstalkAppInstanceProfile"
      },
      "Metadata": {
        "aws:cdk:path": "JVSANTOSTier1BeanstalkAwsArchitectureStack/Tier1BeanstalkAppInstanceProfile"
      }
    },
    "Tier1BeanstalkApplication": {
      "Type": "AWS::ElasticBeanstalk::Application",
      "Properties": {
        "ApplicationName": "Tier1 Application"
      },
      "Metadata": {
        "aws:cdk:path": "JVSANTOSTier1BeanstalkAwsArchitectureStack/Tier1BeanstalkApplication"
      }
    },
    "BeanstalkEnvironment": {
      "Type": "AWS::ElasticBeanstalk::Environment",
      "Properties": {
        "ApplicationName": "Tier1 Application",
        "EnvironmentName": "Tier1-Environment",
        "OptionSettings": [
          {
            "Namespace": "aws:autoscaling:launchconfiguration",
            "OptionName": "IamInstanceProfile",
            "Value": {
              "Fn::GetAtt": [
                "Tier1BeanstalkAppInstanceProfile",
                "Arn"
              ]
            }
          },
          {
            "Namespace": "aws:ec2:vpc",
            "OptionName": "VPCId",
            "Value": {
              "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPC4AEDEE1E826FF0C2"
            }
          },
          {
            "Namespace": "aws:ec2:vpc",
            "OptionName": "Subnets",
            "Value": {
              "Fn::Join": [
                "",
                [
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCPrivateSubnet1SubnetDB2077AF56606861"
                  },
                  ",",
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCPrivateSubnet2Subnet761294B6BB18A85F"
                  },
                  ",",
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCPrivateSubnet3SubnetE32EBA39DED86AAB"
                  }
                ]
              ]
            }
          },
          {
            "Namespace": "aws:ec2:vpc",
            "OptionName": "ELBSubnets",
            "Value": {
              "Fn::Join": [
                "",
                [
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCPublicSubnet1SubnetFD94A3A661F79D3A"
                  },
                  ",",
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCPublicSubnet2Subnet972CA01AF714AC0E"
                  },
                  ",",
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCPublicSubnet3SubnetF783E89056321B68"
                  }
                ]
              ]
            }
          },
          {
            "Namespace": "aws:ec2:vpc",
            "OptionName": "DBSubnets",
            "Value": {
              "Fn::Join": [
                "",
                [
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCIsolatedSubnet1Subnet7F144BE8A93EDDAE"
                  },
                  ",",
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCIsolatedSubnet2SubnetD1D87E0926C244FD"
                  },
                  ",",
                  {
                    "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1VPCIsolatedSubnet3Subnet633096C15F2A7CFF"
                  }
                ]
              ]
            }
          },
          {
            "Namespace": "aws:autoscaling:launchconfiguration",
            "OptionName": "SecurityGroups",
            "Value": {
              "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputFnGetAttBeanstalkApplicationSG52223C1FGroupId191ECD2C"
            }
          },
          {
            "Namespace": "aws:elbv2:loadbalancer",
            "OptionName": "SecurityGroups",
            "Value": {
              "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputFnGetAttBeanstalkApplicationLoadBalancerSGF15D451CGroupIdAC8ED97D"
            }
          },
          {
            "Namespace": "aws:elasticbeanstalk:application:environment",
            "OptionName": "PORT",
            "Value": "1337"
          },
          {
            "Namespace": "aws:elasticbeanstalk:environment",
            "OptionName": "ServiceRole",
            "Value": {
              "Ref": "Tier1BeanstalkServiceRole00DAA13C"
            }
          },
          {
            "Namespace": "aws:elasticbeanstalk:environment",
            "OptionName": "EnvironmentType",
            "Value": "LoadBalanced"
          },
          {
            "Namespace": "aws:elasticbeanstalk:environment",
            "OptionName": "LoadBalancerType",
            "Value": "application"
          },
          {
            "Namespace": "aws:ec2:instances",
            "OptionName": "InstanceTypes",
            "Value": "t3.micro"
          },
          {
            "Namespace": "aws:elbv2:listenerrule:default",
            "OptionName": "PathPatterns",
            "Value": "/**/*"
          },
          {
            "Namespace": "aws:elasticbeanstalk:healthreporting:system",
            "OptionName": "SystemType",
            "Value": "enhanced"
          },
          {
            "Namespace": "aws:autoscaling:asg",
            "OptionName": "MinSize",
            "Value": "2"
          },
          {
            "Namespace": "aws:autoscaling:asg",
            "OptionName": "MaxSize",
            "Value": "4"
          },
          {
            "Namespace": "aws:elbv2:listener:443",
            "OptionName": "ListenerEnabled",
            "Value": "true"
          },
          {
            "Namespace": "aws:elbv2:listener:443",
            "OptionName": "Protocol",
            "Value": "HTTPS"
          },
          {
            "Namespace": "aws:elbv2:listener:443",
            "OptionName": "SSLCertificateArns",
            "Value": {
              "Fn::ImportValue": "JVSANTOSTier1VPCAwsArchitectureStack:ExportsOutputRefTier1ACMCertificate95EAA15BF9B6C393"
            }
          },
          {
            "Namespace": "aws:elasticbeanstalk:environment:process:default",
            "OptionName": "Port",
            "Value": "1337"
          },
          {
            "Namespace": "aws:elasticbeanstalk:application",
            "OptionName": "Application Healthcheck URL",
            "Value": "HTTP:1337/"
          }
        ],
        "SolutionStackName": "64bit Amazon Linux 2 v5.3.0 running Node.js 14",
        "Tags": [
          {
            "Key": "Application",
            "Value": "JVSANTOSTier1"
          }
        ]
      },
      "DependsOn": [
        "Tier1BeanstalkApplication"
      ],
      "Metadata": {
        "aws:cdk:path": "JVSANTOSTier1BeanstalkAwsArchitectureStack/BeanstalkEnvironment"
      }
    },
    "CDKMetadata": {
      "Type": "AWS::CDK::Metadata",
      "Properties": {
        "Analytics": "v2:deflate64:H4sIAAAAAAAACi2LQQ6CMBBFz8K+lBBd4E5DXLiS4AlqHeJImSHtVGOa3l1QVy/57/1a77a6LvbmFUp7G6tk2YNOFzF2VO1A5yhzFNUyBfHRyrr1EDh6C1mtr4Rm0qlnB1/352npDVnoPA/olhScCYL2CmY1btRpqQ7z7NAaQab1dKQneqYJSHLOqnvLnana6EY3xSMglj6S4AS6//ED3BFVyL0AAAA="
      },
      "Metadata": {
        "aws:cdk:path": "JVSANTOSTier1BeanstalkAwsArchitectureStack/CDKMetadata/Default"
      }
    }
  },
  "Outputs": {
    "EBURL": {
      "Value": {
        "Fn::GetAtt": [
          "BeanstalkEnvironment",
          "EndpointURL"
        ]
      }
    },
    "ExportsOutputFnGetAttBeanstalkEnvironmentEndpointURL7DF3B919": {
      "Value": {
        "Fn::GetAtt": [
          "BeanstalkEnvironment",
          "EndpointURL"
        ]
      },
      "Export": {
        "Name": "JVSANTOSTier1BeanstalkAwsArchitectureStack:ExportsOutputFnGetAttBeanstalkEnvironmentEndpointURL7DF3B919"
      }
    }
  }
}